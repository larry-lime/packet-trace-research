<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Thoughts on How to Mount an Attack on tcpdpriv's ``-A50'' Option...</TITLE>
<META NAME="description" CONTENT="Thoughts on How to Mount an Attack on tcpdpriv's ``-A50'' Option...">
<META NAME="keywords" CONTENT="attack50">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="attack50.css">

</HEAD>

<BODY >
<!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive"
 SRC="/usr/share/latex2html/icons/nx_grp_g.png"> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev_g.png">   
<BR>
<BR>
<BR>
<!--End of Navigation Panel-->

<P>

<P>
<H1 ALIGN="CENTER">Thoughts on How to Mount an Attack on tcpdpriv's ``-A50'' Option...</H1>
<DIV>

</DIV>

<P>

<H3>Abstract:</H3>
<DIV>
tcpdpriv(1) provides a mechanism for outputting <I>randomized</I> IP
addresses (using the <I>-A50</I> option).
By so doing, the amount of information encoded in the
outputted IP addresses is larger than the amount of information encoded
in the options that output IP addresses as sequential numbers (but,
less than the amount of information encoded in the <I>-A99</I> option
that causes the IP addresses on the output side to be the same as those
on the input side).  This document discusses an approach that might be
used to <I>crack</I> an output file which has been encoded with the
<I>-A50</I> option.
</DIV>
<P>

<P>

<H1><A NAME="SECTION00010000000000000000">
Acknowledgement and DISCLAIMER</A>
</H1>

<P>
The following is primarily the work of Tatu Ylonen <TT>&lt;ylo@ssh.fi&gt;</TT>, and
is provided here with the following:

<P>
<I>
DISCLAIMER:
THIS INFORMATION IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED.  IN NO EVENT SHALL TATU YLONEN BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS INFORMATION,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
</I>

<P>

<H1><A NAME="SECTION00020000000000000000">
Overview</A>
</H1>

<P>
The coding produced by the <I>-A50</I> option is good enough to
keep Joe Random Hacker out, but not
necessarily good enough to keep governments or well-informed experts
from determining where the data was taken from.  Note that once
you have accurately located a single machine, you know quite
accurately the addresses of other machines on the local network.
You can also make guesses like ``I bet the external gateway (which
you can easily recognize from traffic patterns, as well as from
having e.g. cisco's hardware ethernet address) has either address
.1 or .254'', etc., and guess quite a bit of the remaining information.
Also, it is quite common to have the name server at .1.

<P>

<H1><A NAME="SECTION00030000000000000000">
The Attack</A>
</H1>

<P>
Suppose you wanted to mount a large-scale attack on IP addresses
randommized with the <I>-A50</I> option.  You can fairly easily

<UL>
<LI>get addresses of most domain name servers in the world
     (have a robot scan the name server hierarchy)
</LI>
<LI>get addresses of most WWW servers in the world
     (have a robot scan the web space, like altavista now does)
</LI>
<LI>if you run a major WWW server, you can get addresses of lots of
    WWW cache servers
     (extract from WWW logs)
</LI>
<LI>get addresses of news servers
     (analyze Path lines in news headers from the full newsfeed for
     some time)
</LI>
<LI>get addresses of irc servers
</LI>
<LI>subscribe to the most popular mailing lists in the world to get
    information about arrival dates of messages
</LI>
</UL>

<P>
When you start analyzing privatized data, I would guess you can fairly
easily

<UL>
<LI>identify telnet port
</LI>
<LI>identify rlogin port
</LI>
<LI>identify rsh port
</LI>
<LI>identify domain name server port
</LI>
<LI>identify syslog port
</LI>
<LI>identify ftp port
</LI>
<LI>identify smtp port
</LI>
<LI>identify pop port
</LI>
<LI>identify irc port
</LI>
<LI>identify finger port
</LI>
<LI>identify http port
</LI>
<LI>identify nntp port, especially if there are newsfeeds in the trace
</LI>
<LI>identify nfs port (2049)
</LI>
</UL>

<P>
Also, you can quite easily identify

<UL>
<LI>routers (traffic patterns and physical addresses)
</LI>
<LI>unix servers (telnet, rlogin, rsh)
</LI>
<LI>dns servers (dns traffic)
</LI>
<LI>www servers (http traffic)
</LI>
</UL>

<P>
You get starting points for randomized IP to real IP mapping from e.g.

<UL>
<LI>queries from DNS servers to DNS root servers (whose addresses you know!)
</LI>
<LI>It might be possible to recognize altavista.digital.com.
</LI>
<LI>If the trace is long, it might be possible to correlate arrival
    time of e-mail messages from some hosts to arrival times of mail
    from popular mailing lists.  This would probably allow recognizing
    some mailing list servers.
</LI>
<LI>You can probably recognize which direction in newsfeed is
    upstream.  You can then correlate arrival times of messages through
    particular hosts with the messages seen in the traces.  This will
    probably allow you to recognize directly the nntp servers <I>and
    posting hosts</I>.
</LI>
<LI>The amount of your outgoing irc traffic allows to narrow down on
    the servers.  Correlating outgoing message times and sizes may again be
    enough to pinpoint the particular server.  Data obtained from irc
    servers (/who listings) can then be used to determine who sent
    each message, and correlate it with hosts of the users.
</LI>
<LI>You might recognize e-mail messages going to common mailing list
    servers, correlate their times with messages you have received
    from those servers, and directly determine who sent which and from
    which host.
</LI>
<LI>By now, you probably have enough information to start determining
    the likely addresses of some common WWW servers (using the size of
    their main page, number and sizes of inlined images, etc. as
    additional information, and already guessed bits of their
    addresses).  I would guess you can recognize a lot of WWW servers
    from this data.  If you can get logs from some of these, you
    can directly recognize the client hosts.  (Note that cache servers
    make this task a bit more complicated; however, I would guess that
    it is fairly easy to recognize cache servers).
</LI>
<LI>By now, we most likely know at least some hosts from within the
    domains where the trace was taken.  We can use traceroute to get
    addresses of the routers and map them against randomized
    addresses.
</LI>
<LI>With some luck, you can get hostinfo data from DNS.  With some
    luck, that info includes machine types (manufacturer).  You can
    match this with manufacturer data obtained from physical addresses.
</LI>
<LI>If you have access to some manufacturer's or software supplier's
    license database, you can probably directly map hardware ethernet
    addresses to ip addresses
</LI>
</UL>

<P>

<H1><A NAME="SECTION00040000000000000000">
Summary</A>
</H1>

<P>
Whether this is a problem depends on your threat model.  If you are
very concerned about leaking your network topology, I would not
recommend giving out trace information privatized with the <I>-A50</I>
option.  I wouldn't expect this to be the case for most organizations.

<P>
<HR>
<!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive"
 SRC="/usr/share/latex2html/icons/nx_grp_g.png"> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev_g.png">   
<BR>
<!--End of Navigation Panel-->
<ADDRESS>
greg minshall <a href=mailto:minshall@ipsilon.com>&lt; minshall@ipsilon.com&gt;</a>
</ADDRESS>
</BODY>
</HTML>
